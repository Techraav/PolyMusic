/*!CK:1470604866!*//*1456858659,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["1wKZF"]); }

__d('MercuryThirdPartyMediaAttachmentContent.react',['CenteredContainer.react','ControlledRefererIFrame.react','FBOverlayBase.react','FBOverlayContainer.react','FBOverlayElement.react','Image.react','ImageBlock.react','MercuryFallbackShareAttachmentTextBlock.react','MercuryShareAttachmentRenderLocations','MercuryThirdPartyMediaReactShape','React','ReactDOM','ResponsiveBlock.react','cx','ix','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){'use strict';if(c.__markCompiled)c.__markCompiled();var x=r.PropTypes,y={IMAGE:'image',MEDIA:'media'},z=r.createClass({displayName:'MercuryThirdPartyMediaAttachmentContent',propTypes:{attachment:x.object.isRequired,location:x.oneOf(p.getValues()).isRequired,media:q.isRequired},getInitialState:function(){return {showMedia:false,imageDimensions:this._getDimensions(y.IMAGE),mediaDimensions:this._getDimensions(y.MEDIA)};},render:function(){var ba=this.props.attachment,ca=this.props.location,da=this.props.media,ea=(p.CHAT===ca?"_49or":'')+(p.MESSENGER===ca?' '+"_tih":'')+(!(ba&&ba.media.image)?' '+"_49ou":'');if(ca===p.CHAT){return (r.createElement(t,{onResize:this._updateMediaSize,ref:'wrapper',className:da.chatTextClasses},this._renderMediaFrame(),r.createElement(n,{className:w(ea,this.state.showMedia?"hidden_elem":''),spacing:'medium'},this._renderImageWithPlayButton(),r.createElement('div',{className:"_4cra",style:{height:this.state.imageDimensions.height}},r.createElement(o,{attachment:ba,location:ca})))));}else if(ca===p.MESSENGER)return (r.createElement(t,{onResize:this._updateMediaSize,ref:'wrapper'},r.createElement('div',{className:w(this.props.className,this._computeClass())},this._renderMediaFrame(),r.createElement('div',{className:this.state.showMedia&&!this.props.media.showMediaWithText?"hidden_elem":''},this._renderImageWithPlayButton(),r.createElement('div',{className:da.messengerTextClasses},r.createElement(o,{attachment:ba,location:ca}))))));},_updateMediaSize:function(){this.setState({imageDimensions:this._getDimensions(y.IMAGE),mediaDimensions:this._getDimensions(y.MEDIA)});},_computeClass:function(){if(!this.props.attachment.media||!this.props.attachment.media.image)return "_3xn3 _5swn";var ba=this._getDimensions(this.state.showMedia?y.MEDIA:y.IMAGE),ca=ba.height,da=ba.width,ea=ca>da;return "_3xn3"+(aa(ca,da)&&!ea?' '+"_3xn5":'')+(ea?' '+"_3xn6":'')+(da>=ca?' '+"_3xn7":'');},_getDefaultDimensions:function(ba){var ca=this.props.media;if(this._locationIsChat()){return ba===y.IMAGE?ca.chatImageDimensions:ca.chatMediaDimensions;}else return ba===y.IMAGE?ca.messengerImageDimensions:ca.messengerMediaDimensions;},_getDimensions:function(ba){var ca=this._getDefaultDimensions(ba),da=s.findDOMNode(this.refs.wrapper);if(da){var ea=ca.aspectRatio,fa=da.offsetWidth;if(ea!=null){return {aspectRatio:ea,height:fa*ea,lockHeight:false,width:fa};}else if(ca.lockHeight){return {aspectRatio:null,height:ca.height,lockHeight:true,width:fa};}else return ca;}else return ca;},_handleClick:function(ba){ba.preventDefault();this.setState({showMedia:true,iframeWidth:s.findDOMNode(this.refs.wrapper).offsetWidth});},_renderImageWithPlayButton:function(){var ba=this.state.imageDimensions,ca={height:ba.height,width:ba.width};return (r.createElement(k,{className:(this.state.showMedia?"hidden_elem":'')+(' '+"clearfix"),style:ca},r.createElement(j,null,r.createElement(m,{style:ca,src:this.props.attachment.media.image})),r.createElement(l,null,r.createElement(h,{vertical:true},r.createElement(m,{className:"_4crc",onClick:this._handleClick,src:v('/images/chat/chat_play_icon.png')})))));},_renderMediaFrame:function(){var ba=this.state.mediaDimensions;return (r.createElement('div',{className:!this.state.showMedia?"hidden_elem":''},r.createElement(i,{allowTransparency:true,frameBorder:0,height:ba.height,src:this.props.media.mediaSrc,width:ba.width,allowFullScreen:true})));},_locationIsChat:function(){return this.props.location===p.CHAT;}});function aa(ba,ca){return ba<=300&&ca<=300;}f.exports=z;},null);