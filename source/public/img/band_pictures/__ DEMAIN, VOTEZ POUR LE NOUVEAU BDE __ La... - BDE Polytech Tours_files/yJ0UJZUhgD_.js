/*!CK:28073607!*//*1456940404,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["RfEVc"]); }

__d("GroupSellProductDetailsEvent",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={PHOTO_CLICK:"photo_click",SHOW_DIALOG:"show_dialog",HIDE_DIALOG:"hide_dialog",PROFILE_LINK_CLICK:"profile_link_click",GROUP_LINK_CLICK:"group_link_click",PERMALINK_CLICK:"permalink_click",ASYNC_DATA_REQUEST_FAIL:"async_data_request_fail",DIALOG_INSTANCE_NULL:"dialog_instance_null",MESSAGE_SELLER_CLICK:"message_seller_click",UFI_CLICK:"ufi_click",MARK_AS_SOLD_CLICK:"mark_as_sold_click",FAILED_SALE_POST_GEN:"failed_sale_post_gen"};},null);
__d("GroupSellProductDetailsImageAspect",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={HORIZONTAL:"horizontal",VERTICAL:"vertical",WIDE_HORIZONTAL:"wide_horizontal",WIDE_VERTICAL:"wide_vertical",SQUARE:"square",HEIGHT_BOUND:"height_bound"};},null);
__d('UFIFeedbackContext.react',['React','UFICentralUpdates','UFIFeedbackTargets'],function a(b,c,d,e,f,g,h,i,j){'use strict';if(c.__markCompiled)c.__markCompiled();var k=h.PropTypes,l=h.createClass({displayName:'UFIFeedbackContext',_feedbackTargetSubscriberID:null,propTypes:{contextArgs:k.object.isRequired,render:k.func.isRequired},contextTypes:{stores:k.object},getInitialState:function(){return {contextArgs:this.props.contextArgs,feedback:null};},loadFeedbackTarget:function(m){if(!this._feedbackTargetSubscriberID)this._feedbackTargetSubscriberID=j.getFeedbackTarget(m,function(n){this._fbTargetSubscriberID=null;this.setState({feedback:n});}.bind(this));},componentDidMount:function(){this.loadFeedbackTarget(this.state.contextArgs.ftentidentifier);this.ufiCentralUpdatesSubscriptions=[i.subscribe('instance-updated',function(m,n){var o=this.state.contextArgs;if(o.instanceid in n.updates)this.loadFeedbackTarget(o.ftentidentifier);}.bind(this)),i.subscribe('feedback-updated',function(m,n){var o=this.state.contextArgs;if(o.ftentidentifier in n.updates)this.loadFeedbackTarget(o.ftentidentifier);}.bind(this)),i.subscribe('feedback-id-changed',function(m,n){var o=this.state.contextArgs;if(o.ftentidentifier in n.updates){var p=n.updates[o.ftentidentifier];this.setState({contextArgs:babelHelpers['extends']({},o,{ftentidentifier:p})});this.loadFeedbackTarget(p);}}.bind(this))];},componentWillUnmount:function(){this.ufiCentralUpdatesSubscriptions.forEach(function(m){return m&&i.unsubscribe(m);});if(this._feedbackTargetSubscriberID)j.unsubscribe(this._feedbackTargetSubscriberID);},render:function(){if(this.state.feedback)return this.props.render(this.state.contextArgs,this.state.feedback);return null;}});f.exports=l;},null);
__d('UFIAddCommentController',['Parent','React','ReactDOM','UFIActionTypes','UFIAddComment.react','UFICallbackStore','UFIDispatcher','UFIDispatcherContext.react','UFIFeedbackContext.react','UFIInstanceState','UFINewCommentNotifier'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){if(c.__markCompiled)c.__markCompiled();function s(t,u){'use strict';this.$UFIAddCommentController1=t;this.$UFIAddCommentController2=u;this.$UFIAddCommentController2.rootid=t.id;this.$UFIAddCommentController3=new n();this.$UFIAddCommentController4={UFICallbackStore:new m(this.$UFIAddCommentController3)};this.$UFIAddCommentController4.UFICallbackStore.on(k.ADD_COMMENT.SUBMIT_NEW,function(v){return r.onNewComment(h.byTag(t,'form'),this.$UFIAddCommentController2,v.comment,v.target,v.replyCommentID,v.timestamp);}.bind(this));this.render();}s.prototype.render=function(){'use strict';var t=i.createElement(o,{dispatcher:this.$UFIAddCommentController3,stores:this.$UFIAddCommentController4},i.createElement(p,{contextArgs:this.$UFIAddCommentController2,render:this.renderAddComment}));j.render(t,this.$UFIAddCommentController1);};s.prototype.renderAddComment=function(t,u){'use strict';var v=q.getKeyForInstance(t.instanceid,'isediting');if(v||!u||!u.cancomment||!u.actorforpost)return null;return (i.createElement(l,{viewerActorID:u.actorforpost,replyCommentID:null,targetID:u.ownerid,initialData:null,ref:null,withoutSeparator:null,editingComment:{},isEditing:false,mentionsDataSource:u.mentionsdatasource,showSendOnEnterTip:u.showsendonentertip,allowPhotoAttachments:u.allowphotoattachments&&!t.isstreaming,allowVideoAttachments:u.allowvideoattachments&&!t.isstreaming,allowStickerAttachments:u.allowstickerattachments&&!t.isstreaming,contextArgs:t,subtitle:u.subtitle,isQAndA:u.isqanda}));};f.exports=s;},null);
__d("MutationObserver",[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();h.prototype.observe=function(j,k){"use strict";};h.prototype.disconnect=function(){"use strict";};h.prototype.takeRecords=function(){"use strict";return null;};function h(){"use strict";}var i=b.MutationObserver||b.WebKitMutationObserver||h;f.exports=i;},null);
__d('SimpleObjectsPool',['invariant'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();function i(j){'use strict';this.$SimpleObjectsPool1=j;this.$SimpleObjectsPool2=[];}i.prototype.get=function(){'use strict';if(this.$SimpleObjectsPool2.length){return this.$SimpleObjectsPool2.pop();}else{var j=this.$SimpleObjectsPool1;return new j();}};i.prototype.put=function(j){'use strict';!(j instanceof this.$SimpleObjectsPool1)?h(0):undefined;this.$SimpleObjectsPool2.push(j);};f.exports=i;},null);
__d('PersistentAnimationFrame',['SimpleObjectsPool','Visibility','cancelAnimationFrame','requestAnimationFrame'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=16,m,n={},o=true;function p(){if(!m)m=new h(q);return m;}q.request=function(t){'use strict';if(!t)return 0;return p().get().request(t);};q.cancel=function(t){'use strict';if(t===0)return;var u=n[String(t)];if(u)u.cancel();};function q(){'use strict';this.$PersistentAnimationFrame1=this.$PersistentAnimationFrame1.bind(this);}q.prototype.request=function(t){'use strict';o&&r();this.callback=t;this.hidden=i.isHidden();if(this.hidden){this.intID=setTimeout(this.$PersistentAnimationFrame1,l);}else this.intID=k(this.$PersistentAnimationFrame1);this.strID=String(this.intID);n[this.strID]=this;return this.intID;};q.prototype.cancel=function(){'use strict';if(this.strID){if(this.hidden){clearTimeout(this.intID);}else j(this.intID);this.$PersistentAnimationFrame2();p().put(this);}};q.prototype.$PersistentAnimationFrame1=function(){'use strict';this.callback();this.$PersistentAnimationFrame2();p().put(this);};q.prototype.$PersistentAnimationFrame2=function(){'use strict';delete n[this.strID];delete this.intID;delete this.strID;delete this.callback;delete this.hidden;};function r(){o=false;i.addListener(i.HIDDEN,s);i.addListener(i.VISIBLE,s);}function s(){Object.keys(n).forEach(function(t){var u=n[t],v=u.callback;u.cancel();v();});}f.exports=q;},null);
__d('requestPersistentAnimationFrame',['PersistentAnimationFrame'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();f.exports=h.request;},null);
__d('ResizeEventHandler',['requestPersistentAnimationFrame'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();function i(j){this.$ResizeEventHandler1=false;this.$ResizeEventHandler2=j;this.$ResizeEventHandler3=this.$ResizeEventHandler3.bind(this);this.handleEvent=this.handleEvent.bind(this);}i.prototype.handleEvent=function(){if(this.$ResizeEventHandler1===false){this.$ResizeEventHandler1=true;h(this.$ResizeEventHandler3);}};i.prototype.$ResizeEventHandler3=function(){this.$ResizeEventHandler1=false;this.$ResizeEventHandler2();};f.exports=i;},null);
__d('ResponsiveBlock.react',['MutationObserver','React','ReactDOM','ResizeEventHandler','UserAgent','cx','joinClasses','requestAnimationFrame'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p=i.PropTypes,q=l.isBrowser('IE')&&'onresize' in document.createElement('div'),r={attributes:true,characterData:true,childList:true,subtree:true},s=i.createClass({displayName:'ResponsiveBlock',propTypes:{onResize:p.func.isRequired},componentDidMount:function(){this._width=null;this._height=null;this._resizeHandler=new k(this._didResize);this._bindResizeEvent();this._observer=new h(this._resizeHandler.handleEvent);this._observer.observe(j.findDOMNode(this),r);},componentWillUnmount:function(){if(this._sensorTarget){this._sensorTarget.onresize=null;this._sensorTarget=null;}this._resizeHandler=null;if(this._observer){this._observer.disconnect();this._observer=null;}this._width=null;this._height=null;},render:function(){var t=n("_4u-c",this.props.className),u;if(q){u=i.createElement('div',{key:'sensor',ref:'sensorNode',className:"_4u-f"});}else u=i.createElement('div',{key:'sensor',className:"_4u-f"},i.createElement('iframe',{'aria-hidden':'true',ref:'sensorNode',className:"_4u-g",tabIndex:'-1'}));return (i.createElement('div',babelHelpers['extends']({},this.props,{className:t}),this.props.children,u));},_bindResizeEvent:function(){if(!this.isMounted())return;if(q){this._sensorTarget=j.findDOMNode(this.refs.sensorNode);}else this._sensorTarget=j.findDOMNode(this.refs.sensorNode).contentWindow;if(this._sensorTarget){this._sensorTarget.onresize=this._resizeHandler.handleEvent;this._resizeHandler.handleEvent();}else o(this._bindResizeEvent);},_didResize:function(){if(this.isMounted()){var t=j.findDOMNode(this),u=t.offsetWidth,v=t.offsetHeight;if(u!==this._width||v!==this._height){this._width=u;this._height=v;this.props.onResize(u,v);}}}});f.exports=s;},null);
__d('GroupSellProductDetailActionsTypedLogger',['Banzai','GeneratedLoggerUtils','nullthrows'],function a(b,c,d,e,f,g,h,i,j){'use strict';if(c.__markCompiled)c.__markCompiled();function k(){this.clear();}k.prototype.log=function(){i.log('logger:GroupSellProductDetailActionsLoggerConfig',this.$GroupSellProductDetailActionsTypedLogger1,h.BASIC);};k.prototype.logVital=function(){i.log('logger:GroupSellProductDetailActionsLoggerConfig',this.$GroupSellProductDetailActionsTypedLogger1,h.VITAL);};k.prototype.clear=function(){this.$GroupSellProductDetailActionsTypedLogger1={};return this;};k.prototype.updateData=function(m){this.$GroupSellProductDetailActionsTypedLogger1=babelHelpers['extends']({},this.$GroupSellProductDetailActionsTypedLogger1,m);return this;};k.prototype.setEvent=function(m){this.$GroupSellProductDetailActionsTypedLogger1.event=m;return this;};k.prototype.setGroupID=function(m){this.$GroupSellProductDetailActionsTypedLogger1.group_id=m;return this;};k.prototype.setReferralSurface=function(m){this.$GroupSellProductDetailActionsTypedLogger1.referral_surface=m;return this;};k.prototype.setStoryID=function(m){this.$GroupSellProductDetailActionsTypedLogger1.story_id=m;return this;};k.prototype.setSurface=function(m){this.$GroupSellProductDetailActionsTypedLogger1.surface=m;return this;};k.prototype.setVC=function(m){this.$GroupSellProductDetailActionsTypedLogger1.vc=m;return this;};var l={event:true,group_id:true,referral_surface:true,story_id:true,surface:true,vc:true};f.exports=k;},null);
__d('GroupCommerceProductDetailImageContainer.react',['DOM','Event','GroupSellProductDetailActionsTypedLogger','GroupSellProductDetailsEvent','GroupSellProductDetailsImageAspect','Image.react','React','Style','Vector','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){'use strict';var r,s;if(c.__markCompiled)c.__markCompiled();var t=n.PropTypes,u=38,v=10,w=483;r=babelHelpers.inherits(x,n.Component);s=r&&r.prototype;function x(y,z){s.constructor.call(this,y,z);var aa=this;aa.$GroupCommerceProductDetailImageContainer2=this.$GroupCommerceProductDetailImageContainer2.bind(this);aa.$GroupCommerceProductDetailImageContainer3=this.$GroupCommerceProductDetailImageContainer3.bind(this);this.state={currentIndex:0,stageWidth:w,stageHeight:558};}x.prototype.render=function(){return (n.createElement('div',null,n.createElement('div',{className:"_57xm"},this.$GroupCommerceProductDetailImageContainer4()),n.createElement('div',{className:"_57xn"},this.props.media.length==0?this.$GroupCommerceProductDetailImageContainer5():this.$GroupCommerceProductDetailImageContainer6())));};x.prototype.componentDidUpdate=function(y,z){if(this.props.media&&this.props.media.length>1&&this.props.media!==y.media){this.$GroupCommerceProductDetailImageContainer7();this.$GroupCommerceProductDetailImageContainer1=i.listen(document.body,'keydown',this.$GroupCommerceProductDetailImageContainer3);}else if(!this.props.media||this.props.media.length<1)this.$GroupCommerceProductDetailImageContainer7();};x.prototype.componentWillUnmount=function(){this.$GroupCommerceProductDetailImageContainer7();};x.prototype.componentWillReceiveProps=function(y){var z=this;if(this.props.media!==y.media){var aa=0;if(y.media.length<1){this.setState({stageWidth:w});}else (function(){var ba=z.props.query;if(ba&&ba.fbid){aa=y.media.findIndex(function(ca){return ca.id.toString()===ba.fbid;});if(aa==-1)aa=0;}z.$GroupCommerceProductDetailImageContainer8(aa,y.media);})();this.setState({currentIndex:aa});}};x.prototype.$GroupCommerceProductDetailImageContainer5=function(){var y=this.props.elem;if(!y)return null;var z=h.scry(y,'img')[0],aa=h.scry(y,'i')[0],ba=null,ca=null;if(z){ba=z.src;ca=p.from(z.naturalWidth,z.naturalHeight);}else if(aa){ba=o.get(aa,'backgroundImage').replace(/.*url\("?([^"]*)"?\).*/,'$1');ca=p.from(z.naturalWidth,z.naturalHeight);}else return null;if(!ca.x||!ca.y||!ba)return null;return (n.createElement(m,{className:"_580_",width:ca.x,height:ca.y,src:ba,style:this.$GroupCommerceProductDetailImageContainer9(ca.x,ca.y)}));};x.prototype.$GroupCommerceProductDetailImageContainer3=function(event){switch(event.keyCode){case 37:case 38:event.stopPropagation();this.$GroupCommerceProductDetailImageContainer10();break;case 39:case 40:event.stopPropagation();this.$GroupCommerceProductDetailImageContainer11();break;}};x.prototype.$GroupCommerceProductDetailImageContainer7=function(){if(this.$GroupCommerceProductDetailImageContainer1){this.$GroupCommerceProductDetailImageContainer1.remove();this.$GroupCommerceProductDetailImageContainer1=null;}};x.prototype.$GroupCommerceProductDetailImageContainer2=function(y){new j().setEvent(k.PHOTO_CLICK).setStoryID(this.props.storyID).setGroupID(this.props.group.id).log();this.$GroupCommerceProductDetailImageContainer8(y,this.props.media);this.setState({currentIndex:y});};x.prototype.$GroupCommerceProductDetailImageContainer8=function(y,z){var aa=z[y],ba=this.state.stageWidth;switch(aa.aspect){case l.HORIZONTAL:case l.WIDE_HORIZONTAL:ba=744;break;case l.WIDE_VERTICAL:ba=314;break;case l.VERTICAL:ba=419;break;case l.SQUARE:ba=558;break;case l.HEIGHT_BOUND:ba=aa.width;break;}this.props.onResize(aa.aspect,ba);this.setState({stageWidth:ba});};x.prototype.$GroupCommerceProductDetailImageContainer11=function(){var y=this.state.currentIndex+1,z=this.props.media.length-1;if(y>v||y>z)y=0;this.$GroupCommerceProductDetailImageContainer2(y);};x.prototype.$GroupCommerceProductDetailImageContainer10=function(){var y=this.state.currentIndex-1,z=this.props.media.length-1;if(y<0)y=v<z?v:z;this.$GroupCommerceProductDetailImageContainer2(y);};x.prototype.$GroupCommerceProductDetailImageContainer6=function(){var y=[],z=this.props.media.length;for(var aa=0;aa<z&&aa<=v;aa++){var ba=this.props.media[aa];y.push(n.createElement(m,{className:(this.state.currentIndex!=aa?"_5810":'')+(' '+"_580_"),width:ba.width,height:ba.height,src:ba.uri,key:'stage'+ba.id,style:this.$GroupCommerceProductDetailImageContainer9(ba.width,ba.height)}));}return y;};x.prototype.$GroupCommerceProductDetailImageContainer9=function(y,z){var aa=0;if(y>this.state.stageWidth){aa=this.state.stageWidth/y;y*=aa;z*=aa;}if(z>this.state.stageHeight){aa=this.state.stageHeight/z;y*=aa;z*=aa;}return {paddingTop:(this.state.stageHeight-z)/2+'px',paddingLeft:(this.state.stageWidth-y)/2+'px',maxWidth:this.state.stageWidth,maxHeight:this.state.stageHeight};};x.prototype.$GroupCommerceProductDetailImageContainer4=function(){var y=[],z=this.props.media.length;for(var aa=0;aa<z&&aa<=v;aa++){var ba=this.props.media[aa];y.push(n.createElement(m,{className:"_5811"+(this.state.currentIndex==aa?' '+"_5812":''),width:u,height:u,src:ba.uriThumb,onClick:this.$GroupCommerceProductDetailImageContainer2.bind(this,aa),key:'thumbnail'+ba.id}));}return (n.createElement('div',null,y));};x.propTypes={group:t.object.isRequired,media:t.any.isRequired,onResize:t.func.isRequired,storyID:t.string,query:t.object,elem:t.object};f.exports=x;},null);
__d('GroupCommerceProductDetailRHCContent.react',['GroupSellProductDetailActionsTypedLogger','GroupSellProductDetailsEvent','Image.react','Link.react','React','XUIText.react','cx','ix'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){'use strict';var p,q;if(c.__markCompiled)c.__markCompiled();var r=l.PropTypes;p=babelHelpers.inherits(s,l.Component);q=p&&p.prototype;s.prototype.render=function(){var t=this.$GroupCommerceProductDetailRHCContent1(),u=this.$GroupCommerceProductDetailRHCContent2();return (l.createElement('div',{className:"_4g63"+(!this.props.actor.profilePicURI?' '+"_34xy":'')},l.createElement('div',{className:"_4g65"},u,t,l.createElement(m,{className:"_4g66"},this.props.product.price),l.createElement('div',{className:"_4g67"},this.props.description,l.createElement('div',{className:"_4g68"},this.props.actionButton))),l.createElement('div',{className:"_4g6d",ref:'ufi',onClick:function(){new h().setEvent(i.UFI_CLICK).setStoryID(this.props.storyID).setGroupID(this.props.group.id).log();}.bind(this)},this.props.ufi)));};s.prototype.$GroupCommerceProductDetailRHCContent2=function(){var t=this.props.product.statusText?this.props.product.statusText+' '+this.props.product.title:this.props.product.title;return (l.createElement(m,{id:this.props.titleID,className:"_4g6e"},t));};s.prototype.$GroupCommerceProductDetailRHCContent1=function(){var t=!this.props.product.deliveryNote?null:l.createElement(m,{display:'inline'},this.props.product.deliveryNote),u=t?' \u00b7 ':null,v=t?l.createElement(j,{className:"_4g6g",src:o('images/groups/sell/place_icon_sell.png')}):null;return (l.createElement('div',{className:"_4g6h"},v,l.createElement(m,null,t),u,l.createElement('div',{className:"_4g6i"},l.createElement(k,{href:this.props.product.uri,onClick:function(){new h().setEvent(i.PERMALINK_CLICK).setStoryID(this.props.storyID).setGroupID(this.props.group.id).log();this.props.hideDialog();}.bind(this)},this.props.timestamp))));};function s(){p.apply(this,arguments);}s.propTypes={actor:r.object.isRequired,product:r.object.isRequired,group:r.object.isRequired,feedback:r.object.isRequired,timestamp:r.any.isRequired,ufi:r.any.isRequired,actionButton:r.any.isRequired,storyID:r.string,description:r.any.isRequired,titleID:r.string};f.exports=s;},null);
__d('GroupCommerceProductDetailRHCFooter.react',['Event','MentionsInputTypeaheadView.react','React','ReactDOM','UFIAddCommentController','UFIMentionsInputProxy.react','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){'use strict';var o,p;if(c.__markCompiled)c.__markCompiled();var q=j.PropTypes;o=babelHelpers.inherits(r,j.Component);p=o&&o.prototype;r.prototype.componentDidMount=function(){this.$GroupCommerceProductDetailRHCFooter1=h.listen(k.findDOMNode(this.refs.ufiAddComment),'keydown',this.$GroupCommerceProductDetailRHCFooter2);};r.prototype.createUFIAddComment=function(s){if(s.ufi&&s.ufi.params){s.ufi.params.mentionsinput={inputComponent:m,viewComponent:i};new l(k.findDOMNode(this.refs.ufiAddComment),s.ufi.params).render();}};r.prototype.componentWillUnmount=function(){if(this.$GroupCommerceProductDetailRHCFooter1){this.$GroupCommerceProductDetailRHCFooter1.remove();this.$GroupCommerceProductDetailRHCFooter1=null;}};r.prototype.render=function(){return (j.createElement('div',{className:"_3g6i"+(!this.props.actor.profilePicURI?' '+"_34xy":''),key:this.props.ufiInstanceID,ref:'ufiAddComment'}));};r.prototype.$GroupCommerceProductDetailRHCFooter2=function(event){switch(event.keyCode){case 37:case 38:case 39:case 40:event.stopPropagation();break;}};function r(){o.apply(this,arguments);}r.propTypes={ufiInstanceID:q.string.isRequired,ufi:q.object.isRequired,actor:q.object.isRequired};f.exports=r;},null);
__d('GroupCommerceProductDetailRHCHeader.react',['GroupSellProductDetailActionsTypedLogger','GroupSellProductDetailsEvent','Image.react','Link.react','React','ReactLayeredComponentMixin','XUIContextualDialog.react','XUIContextualDialogBody.react','classWithMixins','cx','fbt','ix','mixin'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){'use strict';var u,v;if(c.__markCompiled)c.__markCompiled();var w=l.PropTypes,x=104,y=56;u=babelHelpers.inherits(z,p(l.Component,t(m)));v=u&&u.prototype;z.prototype.renderLayers=function(){return {contextualDialog:l.createElement(n,{contextRef:function(){return this.refs.recommendation;}.bind(this),offsetX:-8,shown:true,hoverContextRef:function(){return this.refs.recommendation;}.bind(this),hideOnEscape:true,hoverHideDelay:0,hoverShowDelay:500,autoFocus:false,width:n.WIDTH.WIDE,position:'below'},l.createElement(o,null,l.createElement('div',{id:this.props.recommendationID}))),actorDialog:l.createElement(n,{contextRef:function(){return this.refs.actorName;}.bind(this),shown:true,hoverContextRef:function(){return this.refs.actorName;}.bind(this),hideOnEscape:true,hoverHideDelay:0,hoverShowDelay:500,autoFocus:false,width:n.WIDTH.WIDE,position:'below'},l.createElement(o,null,l.createElement('div',{id:this.props.actorHoverID}))),actorImageDialog:l.createElement(n,{contextRef:function(){return this.refs.actorImage;}.bind(this),shown:true,hoverContextRef:function(){return this.refs.actorImage;}.bind(this),hideOnEscape:true,hoverHideDelay:0,hoverShowDelay:500,autoFocus:false,width:n.WIDTH.WIDE,position:'below'},l.createElement(o,null,l.createElement('div',{id:this.props.actorImageHoverID}))),groupDialog:l.createElement(n,{contextRef:function(){return this.refs.groupName;}.bind(this),shown:true,hoverContextRef:function(){return this.refs.groupName;}.bind(this),hideOnEscape:true,hoverHideDelay:0,hoverShowDelay:500,autoFocus:false,width:n.WIDTH.WIDE,position:'below'},l.createElement(o,null,l.createElement('div',{id:this.props.groupHoverID})))};};z.prototype.render=function(){var aa=this.$GroupCommerceProductDetailRHCHeader1();return (l.createElement('div',{className:"_34xx"+(!this.props.actor.profilePicURI?' '+"_34xy":'')},l.createElement(j,{className:"_34xz",width:y,height:y,src:this.props.actor.profilePicURI,ref:'actorImage'}),l.createElement('div',{className:"_34x-"},l.createElement('div',{className:"_34x_"},l.createElement('div',{ref:'actorName',className:"_34y0"},l.createElement(k,{href:this.props.actor.uri,onClick:function(){new h().setEvent(i.PROFILE_LINK_CLICK).setStoryID(this.props.storyID).setGroupID(this.props.group.id).log();this.props.hideDialog();}.bind(this)},this.props.actor.name)),l.createElement(j,{className:"_34y1",src:s('images/icons/wall_arrow.gif')}),l.createElement('div',{ref:'groupName',className:"_34y0"},l.createElement(k,{href:this.props.group.uri,onClick:function(){new h().setEvent(i.GROUP_LINK_CLICK).setStoryID(this.props.storyID).setGroupID(this.props.group.id).log();this.props.hideDialog();}.bind(this)},this.props.group.name))),l.createElement('div',{ref:'recommendation',className:"_34y2"},aa)),l.createElement('div',{id:this.props.chevronID})));};z.prototype.$GroupCommerceProductDetailRHCHeader1=function(){if(!this.props.actor.hasRecommendations)return null;var aa=this.props.actor.recommendationsCount,ba=this.props.actor.maxRecommendations,ca=aa<ba?aa:r._("{count} +",[r.param('count',ba-1)]),da=aa!==1?r._("{count} personnes ont recommand\u00e9 {short name of user}",[r.param('count',ca),r.param('short name of user',this.props.actor.shortName)]):r._("{count} personne a recommand\u00e9 {short name of user}",[r.param('count',ca),r.param('short name of user',this.props.actor.shortName)]);return (l.createElement('div',null,l.createElement('div',{className:"_1my1"+(!aa?' '+"_29jg":'')}),l.createElement('div',{className:"_34y3"},da)));};z.prototype.componentDidUpdate=function(aa,ba){var ca=this.refs.actorName.offsetWidth,da=x-ca;this.refs.groupName.style.maxWidth=x+da+'px';};function z(){u.apply(this,arguments);}z.propTypes={actor:w.object.isRequired,group:w.object.isRequired,storyID:w.string,recommendationID:w.string.isRequired,actorHoverID:w.string.isRequired,actorImageHoverID:w.string.isRequired,groupHoverID:w.string.isRequired,chevronID:w.string.isRequired};f.exports=z;},null);
__d("XGroupCommerceMarketplaceProductDetailController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/marketplace\/product_detail\/",{story_id:{type:"String",required:true},ufi_id:{type:"String",required:true},date_time_id:{type:"String",required:true},action_button_id:{type:"String",required:true},recommendation_dialog_id:{type:"String",required:true},actor_dialog_id:{type:"String",required:true},actor_image_dialog_id:{type:"String",required:true},description_id:{type:"String",required:true},title_id:{type:"String",required:true},group_hover_id:{type:"String",required:true},ufi_instance_id:{type:"String",required:true},chevron_id:{type:"String",required:true}});},null);
__d('GroupCommerceProductDetail.react',['AsyncRequest','GroupSellProductDetailActionsTypedLogger','GroupSellProductDetailsEvent','GroupSellProductDetailsImageAspect','LayerFadeOnHide','LayerHideOnEscape','LeftRight.react','GroupCommerceProductDetailRHCHeader.react','GroupCommerceProductDetailImageContainer.react','GroupCommerceProductDetailRHCContent.react','GroupCommerceProductDetailRHCFooter.react','React','ReactLayeredComponentMixin','ReactRenderer','ResponsiveBlock.react','ScrollableArea.react','XGroupCommerceMarketplaceProductDetailController','XUIDialog.react','XUIDialogTitle.react','XUIDialogBody.react','classWithMixins','cx','fbt','guid','mixin'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa){'use strict';var ga,ha;if(c.__markCompiled)c.__markCompiled();var ia=495,ja=891;ga=babelHelpers.inherits(ka,ba(s.Component,fa(t)));ha=ga&&ga.prototype;function ka(la,ma){ha.constructor.call(this,la,ma);var na=this;na.hideDialog=this.hideDialog.bind(this);na.showDialog=this.showDialog.bind(this);na.$GroupCommerceProductDetail1=this.$GroupCommerceProductDetail1.bind(this);na.$GroupCommerceProductDetail2=this.$GroupCommerceProductDetail2.bind(this);na.$GroupCommerceProductDetail3=this.$GroupCommerceProductDetail3.bind(this);na.$GroupCommerceProductDetail4=this.$GroupCommerceProductDetail4.bind(this);this.state={isDialogShown:false,width:ja,rhcHeight:200,payload:this.$GroupCommerceProductDetail5(),ufiID:'ufi_detail_'+ea(),datetimeID:'datetime_'+ea(),actionButtonID:'actionButton'+ea(),recommendationDialogID:'recommendationDialogID'+ea(),actorHoverID:'actorHoverID'+ea(),actorImageHoverID:'actorImageHoverID'+ea(),descriptionID:'descriptionID'+ea(),titleID:'titleID'+ea(),groupHoverID:'groupHoverID'+ea(),ufiInstanceID:'ufiInstanceID'+ea(),chevronID:'chevronID'+ea(),query:null,elem:null};}ka.prototype.componentWillUnmount=function(){this.refs.modal.layer.hide();ka.$GroupCommerceProductDetail6=null;};ka.prototype.renderLayers=function(){var la=s.createElement('div',{id:this.state.datetimeID}),ma=s.createElement('div',{id:this.state.ufiID}),na=s.createElement('div',{id:this.state.actionButtonID}),oa=s.createElement('div',{className:"_3g5q",id:this.state.descriptionID});return {dialog:s.createElement(y,{className:"_5p3y",shown:this.state.isDialogShown,onToggle:this.$GroupCommerceProductDetail1,ref:'modal',width:this.state.width,behaviors:{LayerFadeOnHide:l,LayerHideOnEscape:m}},s.createElement(z,null,da._("D\u00e9tails de l\u2019article")),s.createElement(aa,null,s.createElement('div',{className:"_3g6d"},s.createElement(n,null,s.createElement('div',{className:"_3g6e"},s.createElement(p,{group:this.state.payload.group,media:this.state.payload.media,storyID:this.state.payload.storyID,query:this.state.query,elem:this.state.elem,onResize:this.$GroupCommerceProductDetail4})),s.createElement('div',{className:"_3g6f"},s.createElement(w,{className:"_3g6g",height:this.state.rhcHeight},s.createElement(v,{className:"_3g6h",onResize:this.$GroupCommerceProductDetail2},s.createElement(o,{actor:this.state.payload.actor,group:this.state.payload.group,hideDialog:this.hideDialog,storyID:this.state.payload.storyID,recommendationID:this.state.recommendationDialogID,actorHoverID:this.state.actorHoverID,actorImageHoverID:this.state.actorImageHoverID,groupHoverID:this.state.groupHoverID,chevronID:this.state.chevronID}),s.createElement(q,{actor:this.state.payload.actor,product:this.state.payload.product,group:this.state.payload.group,feedback:this.state.payload.feedback,timestamp:la,actionButton:na,ufi:ma,hideDialog:this.hideDialog,storyID:this.state.payload.storyID,description:oa,titleID:this.state.titleID}))),s.createElement(r,{actor:this.state.payload.actor,ref:'rhcFooter',className:"_3g6i",ufiInstanceID:this.state.ufiInstanceID,ufi:this.state.payload.ufi}))))))};};ka.prototype.render=function(){return null;};ka.prototype.showDialog=function(la,ma,na){var oa=x.getURIBuilder().setString('story_id',la).setString('ufi_id',this.state.ufiID).setString('date_time_id',this.state.datetimeID).setString('action_button_id',this.state.actionButtonID).setString('recommendation_dialog_id',this.state.recommendationDialogID).setString('actor_dialog_id',this.state.actorHoverID).setString('actor_image_dialog_id',this.state.actorImageHoverID).setString('description_id',this.state.descriptionID).setString('title_id',this.state.titleID).setString('group_hover_id',this.state.groupHoverID).setString('ufi_instance_id',this.state.ufiInstanceID).setString('chevron_id',this.state.chevronID).getURI();new h().setURI(oa).setMethod('GET').setHandler(this.$GroupCommerceProductDetail3).setErrorHandler(function(pa){new i().setEvent(j.ASYNC_DATA_REQUEST_FAIL).setStoryID(la.toString()).log();}).setReadOnly(true).send();this.setState({payload:this.$GroupCommerceProductDetail5(),query:ma,elem:na,isDialogShown:true,width:ja});};ka.prototype.hideDialog=function(){this.$GroupCommerceProductDetail1(false);};ka.prototype.$GroupCommerceProductDetail4=function(la,ma){var na=this.state.width;switch(la){case k.HORIZONTAL:case k.WIDE_HORIZONTAL:na=1153;break;case k.WIDE_VERTICAL:na=723;break;case k.VERTICAL:na=828;break;case k.SQUARE:na=967;break;case k.HEIGHT_BOUND:na=ma+409;break;}this.setState({width:na});};ka.prototype.$GroupCommerceProductDetail2=function(la,ma){if(ma>ia)ma=ia;this.setState({rhcHeight:ma});};ka.prototype.$GroupCommerceProductDetail1=function(la){if(ka.$GroupCommerceProductDetail6!==null)this.setState({isDialogShown:la});if(!la){new i().setEvent(j.HIDE_DIALOG).setStoryID(this.state.payload.storyID).setGroupID(this.state.payload.group.id).log();if(ka.$GroupCommerceProductDetail6!==null)setTimeout(function(){this.setState({payload:this.$GroupCommerceProductDetail5(),query:null,elem:null});}.bind(this));}};ka.prototype.$GroupCommerceProductDetail5=function(){return {actor:{profilePicURI:null},group:{},product:{},feedback:{},media:[],ufi:{}};};ka.prototype.$GroupCommerceProductDetail3=function(la){new i().setEvent(j.SHOW_DIALOG).setStoryID(la.payload.storyID).setGroupID(la.payload.group.id).log();this.refs.rhcFooter.createUFIAddComment(la.payload);this.setState({payload:la.payload,isDialogShown:true});};ka.init=function(la){var ma=u.constructAndRenderComponent(ka,{},la);ka.$GroupCommerceProductDetail7=la;ka.$GroupCommerceProductDetail6=ma;if(ka.$GroupCommerceProductDetail8){ka.showDialog(ka.$GroupCommerceProductDetail8,ka.$GroupCommerceProductDetail9,ka.$GroupCommerceProductDetail10);ka.$GroupCommerceProductDetail8=null;ka.$GroupCommerceProductDetail9=null;ka.$GroupCommerceProductDetail10=null;}};ka.showDialog=function(la,ma,na){if(!ka.$GroupCommerceProductDetail6){if(!ka.$GroupCommerceProductDetail7){ka.$GroupCommerceProductDetail8=la;ka.$GroupCommerceProductDetail9=ma;ka.$GroupCommerceProductDetail10=na;return;}ka.init(ka.$GroupCommerceProductDetail7);}if(!ka.$GroupCommerceProductDetail6){new i().setEvent(j.DIALOG_INSTANCE_NULL).setStoryID(la.toString()).log();return;}ka.$GroupCommerceProductDetail6.showDialog(la,ma,na);};ka.$GroupCommerceProductDetail6=null;ka.$GroupCommerceProductDetail8=null;ka.$GroupCommerceProductDetail7=null;ka.$GroupCommerceProductDetail10=null;ka.$GroupCommerceProductDetail9=null;f.exports=ka;},null);
__d('GroupCommerceProductDetailLayer',['Layer','GroupCommerceProductDetail.react'],function a(b,c,d,e,f,g,h,i){'use strict';var j,k;if(c.__markCompiled)c.__markCompiled();j=babelHelpers.inherits(l,h);k=j&&j.prototype;l.prototype._buildWrapper=function(m,n){i.init(n);return n;};function l(){j.apply(this,arguments);}f.exports=l;},null);
__d('OGHovercardLayerHideOnBlur',['ContextualThing','DOM','Event'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();function k(l){this._layer=l;}Object.assign(k.prototype,{_subscriptions:null,_clickListener:null,enable:function(){this._subscriptions=[this._layer.subscribe('show',this._attach.bind(this)),this._layer.subscribe('hide',this._detach.bind(this))];if(this._layer.isShown())this._attach();},disable:function(){this._detach();while(this._subscriptions.length)this._subscriptions.pop().unsubscribe();this._subscriptions=null;},_detach:function(){this._clickListener&&this._clickListener.remove();this._clickListener=null;},_attach:function(){setTimeout(function(){this._clickListener=j.listen(document.documentElement,'click',this._maybeHide.bind(this));}.bind(this),0);},_maybeHide:function(event){var l=event.getTarget();if(i.contains(this._layer.getContent(),l)||h.containsIncludingLayers(this._layer.getContentRoot(),l))return;if(this._shouldHide(event))this._layer.hide();},_shouldHide:function(event){return true;}});f.exports=k;},null);
__d('OGAggregationHovercardTarget',['Event','ArbiterMixin','AsyncRequest','ContextualDialog','ContextualDialogArrow','CSS','DOM','LayerHideOnBlur','LayerHideOnEscape','OGHovercardLayerHideOnBlur','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){if(c.__markCompiled)c.__markCompiled();var t=350,u={};function v(x){return new k({addedBehaviors:[o,p],arrowBehavior:l,classNames:[x]},n.create('div',{className:"_4q1"},s._("Chargement..."))).setWidth(t);}Object.assign(w,{setHovercard:function(x,y){var z=u[x];z&&z.setHovercard(y);}});function w(x,y,z,aa,ba,ca,da,ea,fa){u[y]=this;this._targetID=y;this._endpoint=z;this._preventClose=ba||[];this._position=da||'below';this._dialogClass=ea||'';this._fetchOnHover=fa;this.init(x);for(var ga=0,ha=aa.length;ga<ha;ga++){var ia=aa[ga];this.addTrigger(ia.element,ia.trigger_class,ia.context);}if(ca)this.showHovercard(null,null);}Object.assign(w.prototype,i,{init:function(x){this._hovercardShown=false;this._hovercardScheduled=false;this._target=x;this._triggers=[];this._hovercard=null;this._fetching=false;this._placeholder=null;this._placeholderListener=null;this._shownClass='hover_shown';this._triggerClass=null;this._currentTrigger=null;this._context=null;return this;},addTrigger:function(x,y,z){this._triggers.push(x);h.listen(x,'click',this._onTriggerClick.bind(this,x,y,z));if(this._fetchOnHover)h.listen(x,'mouseover',this._onTriggerMouseOver.bind(this));},_onTriggerMouseOver:function(){this._fetch();},_onTriggerClick:function(x,y,z){z=z||this._target;if(this._hovercardShown&&this._hovercard.getContext()===z||this._hovercardScheduled&&this._placeholder.getContext()===z||(this._hovercardShown||this._hovercardScheduled)&&this._currentTrigger===x){this._currentTrigger=null;this.hideHovercard();return;}this.hideHovercard();this._currentTrigger=x;this.showHovercard(y,z);},_fetch:function(){if(this._hovercard!=null||this._fetching)return;this._fetching=true;var x=function(){this._fetching=false;},y=function(){this.hideHovercard();};new j(this._endpoint).setData({hover_target:this._targetID}).setMethod('GET').setReadOnly(true).setErrorHandler(y.bind(this)).setTransportErrorHandler(y.bind(this)).setFinallyHandler(x.bind(this)).send();},setHovercard:function(x){var y,z,aa=this;this._hovercard=x;y=babelHelpers.inherits(ba,q);z=y&&y.prototype;function ba(ca){'use strict';z.constructor.call(this,ca);}ba.prototype.$conditionalHideOnBlur1=function(event){'use strict';var ca=event.getTarget();for(var da=0,ea=aa.$conditionalHideOnBlur2.length;da<ea;da++)if(n.contains(aa.$conditionalHideOnBlur2[da],ca))return false;return true;};this._hovercard.setPosition(this._position).setAlignment('center').enableBehaviors([ba,p]);this._hovercard.subscribe('aftershow',this._onHovercardShow.bind(this));this._hovercard.subscribe('hide',this._onHovercardHide.bind(this));this._hovercard.subscribe('destroy',this._onHovercardDestroy.bind(this));if(this._hovercardScheduled)this.showHovercard(this._triggerClass,this._context);},showHovercard:function(x,y){m.addClass(this._target,this._shownClass);if(this._triggerClass&&this._triggerClass!==x)m.removeClass(this._target,this._triggerClass);this._triggerClass=x;this._triggerClass&&m.addClass(this._target,this._triggerClass);this._context=y;if(this._hovercard){this._hovercard.setContext(y||this._target).show();this._hovercardShown=true;this._hovercardScheduled=false;this._hidePlaceholder();}else{this._hovercardScheduled=true;this._fetch();this._showPlaceholder();}this.inform('showhovercard');},hideHovercard:function(){this._hovercardScheduled=false;this._hidePlaceholder();if(this._hovercard){this._hovercard.hide();}else this._onHovercardHide();},_showPlaceholder:function(){if(!this._placeholder){this._placeholder=v(this._dialogClass);this._placeholder.setContext(this._context||this._target).setPosition(this._position).setAlignment('center').show();this._placeholderListener=this._placeholder.subscribe('hide',this._onPlaceholderHide.bind(this));}},_hidePlaceholder:function(){this._placeholder&&this._placeholder.hide();},_onPlaceholderHide:function(){if(this._placeholder){this._hovercardScheduled=false;this._placeholderListener&&this._placeholder.unsubscribe(this._placeholderListener);this._placeholder=null;!this._hovercardShown&&this._removeTriggerClasses();}},_onHovercardShow:function(){var x=this._hovercard.getContent(),y=n.scry(x,'textarea.mentionsTextarea')[0];y&&y.focus();},_onHovercardHide:function(){this._hovercardShown=false;this._removeTriggerClasses();this.inform('hidehovercard');},_onHovercardDestroy:function(){this._hovercard=null;},_removeTriggerClasses:function(){m.removeClass(this._target,this._shownClass);this._triggerClass&&m.removeClass(this._target,this._triggerClass);}});f.exports=w;},null);
__d('BulkTagLoader',['AsyncRequest','emptyFunction'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=false;function k(){}Object.assign(k,{loadForSet:function(l){if(!j){j=true;new h('/ajax/photos/sets/tags_fetch.php').setHandler(i).setData({set:l}).send();}},loadForAlbum:function(l){if(!j){j=true;new h('/ajax/photos/album/tags_fetch.php').setHandler(i).setData({fbid:l}).send();}},reset:function(){j=false;}});f.exports=k;},null);
__d('PhotoCurationControl',['Event','Parent','Toggler'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k={init:function(l){var m=i.byClass(l,'fbPhotoStarGridElement');h.listen(m,'mouseleave',function(){j.hide();});}};f.exports=k;},null);
__d('PhotoInlineActions',['Arbiter','AsyncRequest','CSS','Event','Nectar','Parent','csx','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p={init:function(q,r,s,t,u,v,w,x,y,z){var aa=false;h.subscribe(['UFI/CommentAddedActive','UFI/CommentDeletedActive','UFI/LikeActive'],function(ba,ca){if(parseInt(q.getAttribute('data-fbid'),10)!==ca)return;if(ba==='UFI/LikeActive')j.toggleClass(q,"_53a");new i().setURI('/ajax/photos/photo/refresh.php').setData({fbid:q.getAttribute('data-fbid')}).setRelativeTo(q).send();});k.listen(q,'click',function(event){var ba=event.getTarget();if(aa||!m.bySelector(ba,"._53b"))return;event.prevent();j.toggleClass(q,"_53a");var ca={};l.addModuleData(ca,q);aa=new i().setURI('/ajax/photos/photo/like.php').setData(babelHelpers['extends']({fbid:q.getAttribute('data-fbid'),relatedid:r,hovercardendpoint:s,includecommentlink:t,hovercardposition:u,includeleadingseparator:v,dialogClass:w,fetchOnHover:x,includeSocialContext:y,tagURI:z},ca)).setRelativeTo(q).setErrorHandler(function(){j.toggleClass(q,"_53a");}).setFinallyHandler(function(){aa=false;}).send();});}};f.exports=p;},null);
__d('StarGridLayout',['Vector','removeFromArray'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();function j(k){'use strict';Object.assign(this,k);}j.prototype.getShortestColumn=function(k){'use strict';return k[0]<=k[1]?0:1;};j.prototype.getDangling=function(k){'use strict';var l=k.filter(function(m){return !this.isStarred(m);}.bind(this));if(l.length%2===1)return l[l.length-1];return null;};j.prototype.mangleOrder=function(k){'use strict';if(k.length<3||!(this.isFixed(k[0])&&this.isStarred(k[1])))return k;var l=this.nextNonStarred(k,2);if(!l)return k;var m=k.concat();i(m,l);m.splice(1,0,l);return m;};j.prototype.layout=function(k){'use strict';var l=[0,0],m=0,n=this.getDangling(k),o=[];k=this.mangleOrder(k);for(var p=0;p<k.length;++p){var q=this.getShortestColumn(l),r=k[p];if(this.isStarred(r)){this.renderStarred(this._grid,l,q,r);l[q]+=2;m=Math.max(m,q*2+2);}else{o.push(r);if(o.length===2||r===n){this.renderNonStarred(this._grid,l,q,o);m=Math.max(m,q*2+o.length);o=[];l[q]+=1;}}}return new h(m,Math.max.apply(null,l));};j.prototype.inNonStarredBlock=function(k,l,m,n){'use strict';return l===m[n]&&Math.floor(k/2)===n;};j.prototype.inStarredBlock=function(k,l,m,n){'use strict';return (l===m[n]||l===m[n]+1)&&Math.floor(k/2)===n;};j.prototype.nextNonStarred=function(k,l){'use strict';for(;l<k.length;++l)if(!this.isStarred(k[l]))return k[l];return null;};j.prototype.layoutReorder=function(k,l,m,n){'use strict';k=k.concat();m=Math.max(0,Math.min(3,m));n=Math.max(0,n);i(k,l);k.push(l);var o=[0,0],p=this.getDangling(k),q=false,r=[];for(var s=0;s<k.length;++s){var t=this.getShortestColumn(o),u=k[s];if(this.isStarred(u)){if(u===l)q=true;if(!q&&this.isStarred(l)&&this.inStarredBlock(m,n,o,t)&&this.inNonStarredBlock(m,n,o,t)){i(k,l);this.renderStarred(this._grid,o,t,l);o[t]+=2;t=this.getShortestColumn(o);q=true;}if(!q&&!this.isStarred(l)&&this.inStarredBlock(m,n,o,t)&&this.inNonStarredBlock(m,n,o,t)){i(k,l);if(r.length===1){r.splice(m%2,0,l);}else{var v=this.nextNonStarred(k,s);if(v){i(k,v);r.push(v);r.splice(m%2,0,l);}else r.push(l);}this.renderNonStarred(this._grid,o,t,r);r=[];o[t]+=1;p=this.getDangling(k.slice(s+1));t=this.getShortestColumn(o);q=true;}if(!q&&this.inStarredBlock(m,n,o,t)&&!this.inNonStarredBlock(m,n,o,t)){i(k,l);var v=this.nextNonStarred(k,s);k.push(l);if(v){i(k,v);k.splice(s,0,v);s--;continue;}n-=1;s--;continue;}this.renderStarred(this._grid,o,t,u);o[t]+=2;}else{r.push(u);if(r.length===2||u===p){if(!q&&!this.isStarred(l)&&this.inNonStarredBlock(m,n,o,t)){i(r,l);i(k,l);r.splice(m%2,0,l);if(r.length===3){i(k,r[2]);k.splice(s,0,r[2]);s=k.indexOf(r[2])-1;r.pop();}p=this.getDangling(k.slice(s+1));q=true;}if(!q&&this.isStarred(l)&&this.inNonStarredBlock(m,n,o,t)){i(k,l);this.renderStarred(this._grid,o,t,l);o[t]+=2;t=this.getShortestColumn(o);q=true;}this.renderNonStarred(this._grid,o,t,r);r=[];o[t]+=1;}}}};j.prototype.getStoringLayout=function(k){'use strict';return new j({grid:this._grid,isStarred:this.isStarred,isFixed:this.isFixed,renderStarred:function(l,m,n,o){k.push(o);},renderNonStarred:function(l,m,n,o){k.push(o[0]);if(o.length>1)k.push(o[1]);}});};j.prototype.reorder=function(k,l,m,n){'use strict';var o=[];this.getStoringLayout(o).layoutReorder(k,l,m,n);return o;};j.prototype.canonicalize=function(k){'use strict';var l=[];this.getStoringLayout(l).layout(k);return l;};f.exports=j;},null);
__d('StarGrid',['Arbiter','CSS','DataStore','DOM','Locale','Parent','Style','StarGridLayout','removeFromArray'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){if(c.__markCompiled)c.__markCompiled();var q={MARGIN:5,isStarred:function(r){return i.hasClass(r,'fbPhotoStarGridStarred');},isFixed:function(r){return i.hasClass(r,'fbPhotoStarGridFixed');},setPosition:function(r,s,t){var u=l.isRTL()?'margin-right':'margin-left';n.set(r,'position','absolute');n.set(r,'margin-top',s+'px');n.set(r,u,t+'px');},renderNonStarred:function(r,s,t,u){for(var v=0;v<u.length;++v){var w=s[t]*q.getSize(r),x=(t*2+v)*q.getSize(r);q.setPosition(u[v],w,x);}},renderStarred:function(r,s,t,u){var v=s[t]*q.getSize(r),w=t*2*q.getSize(r);q.setPosition(u,v,w);},mergeWithPreviousGrid:function(r){var s=r.previousSibling;if(s&&i.hasClass(s,'fbStarGrid')){i.addClass(s,'fbStarGridAppendedTo');while(r.firstChild)s.appendChild(r.firstChild);k.remove(r);r=s;}return r;},addPhotos:function(r){var s=k.scry(document.body,'.fbStarGrid')[0];if(!s)return;k.prependContent(s,r);var t=this.getSize(s);this.mergeAndLayoutGrid(s,t);},removeFromGrid:function(r){var s=m.byClass(r,'fbStarGrid'),t=q.getElements(s);p(t,r);k.remove(r);q.layoutGrid(s,t);h.inform('StarGrid/UPDATE',s);},removePhoto:function(r){var s=k.scry(document.body,'.fbPhotoStarGridElement[data-fbid="'+r+'"]')[0];this.removeFromGrid(s);},removeUntaggedPhoto:function(r){var s=k.scry(document.body,'.fbPhotoStarGridElement[data-fbid="'+r+'"]'+'[data-in-photos-of="1"]');if(s.length>0)this.removeFromGrid(s[0]);},removePhotos:function(r){var s,t;for(var u=0;u<r.length;u++){var v=r[u],w=k.scry(document.body,'.fbPhotoStarGridElement[data-fbid="'+v+'"]')[0];s=m.byClass(w,'fbStarGrid');t=q.getElements(s);p(t,w);k.remove(w);}q.layoutGrid(s,t);h.inform('StarGrid/UPDATE',s);},layoutGrid:function(r,s){var t=new o({_grid:r,isStarred:q.isStarred,isFixed:q.isFixed,renderNonStarred:q.renderNonStarred,renderStarred:q.renderStarred});q.setElements(r,s);var u=t.layout(s);n.set(r,'width',u.x*q.getSize(r)+'px');n.set(r,'height',u.y*q.getSize(r)+'px');},mergeAndLayoutGrid:function(r,s){var t=k.scry(r,'.fbPhotoStarGridElement'),u=q.mergeWithPreviousGrid(r),v=t;if(r!==u)v=q.getElements(u).concat(t);q.setElements(r,v);j.set(r,'size',s);q.layoutGrid(u,v);h.subscribe('PhotosBulkEditablePhoto.MOVED',function(w,x){q.removePhoto(x);}.bind(this));h.inform('StarGrid/UPDATE',r);},getSize:function(r){return j.get(r,'size');}};Object.assign(q,{getElements:function(r){var s=j.get(r,'elements');if(!s){s=k.scry(r,'div.fbPhotoStarGridElement');q.setElements(r,s);}return s;},setElements:function(r,s){j.set(r,'elements',s);}});f.exports=q;},null);
__d('TagSuggestionsDrawer',['AsyncRequest','PhotosAppSection'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=false,k={init:function(){if(j)return;j=true;i.subscribe('toggle_drawer',k._onToggle);},_onToggle:function(l,m){if(m.button_clicked=='show'){k._notify(false);}else k._notify(true);},_notify:function(l){new h('/ajax/medley/tag_suggestions_drawer.php').setData({is_closed:l}).send();}};f.exports=k;},null);